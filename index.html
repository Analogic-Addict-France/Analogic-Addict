<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analogic Addict France - Accueil</title>
    <link rel="stylesheet" href="style.css">
    <style>
        :root {
            --primary: #6C516C;
            --bg: #1B1B1B;
            --text: #f4f4f4;
            --card-bg: #252525;
            --discord-blurple: #5865F2;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 0;
        }

        nav {
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            padding: 10px 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid var(--primary);
        }

        .nav-container {
            max-width: 1100px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 15px;
        }

        .logo img { height: 35px; width: auto; }
        .nav-links { display: flex; gap: 15px; }
        .nav-links a { color: white; text-decoration: none; font-size: 0.9em; font-weight: bold; }

        .container { max-width: 1100px; margin: auto; padding: 15px; }

        .wiki-btn {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(90deg, var(--primary), #4a384a);
            padding: 15px;
            border-radius: 10px;
            text-decoration: none;
            color: white;
            font-weight: bold;
            margin-bottom: 20px;
            transition: 0.3s;
        }

        .home-grid {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 20px;
        }

        .music-card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 20px;
            border-left: 5px solid var(--primary);
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .music-content-wrapper {
            display: flex;
            flex-direction: row;
            gap: 20px;
            align-items: start;
        }

        /* Image forcÃ©e en CarrÃ© */
        .music-img {
            width: 35%;
            aspect-ratio: 1 / 1; 
            object-fit: cover;
            border-radius: 10px;
            background: #111;
        }

        .music-info { width: 65%; }

        .playing-animation {
            display: inline-flex;
            gap: 3px;
            height: 15px;
            margin-left: 10px;
        }
        .bar { width: 3px; background: var(--primary); animation: bounce 1s infinite; }
        @keyframes bounce { 0%, 100% { height: 5px; } 50% { height: 15px; } }

        /* Style des boutons sous la musique */
        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 15px;
        }

        .btn {
            padding: 14px;
            border-radius: 10px;
            text-decoration: none;
            display: block;
            text-align: center;
            font-weight: bold;
            border: none;
            cursor: pointer;
            transition: 0.3s;
            font-size: 1em;
        }

        .btn-discord {
            background-color: var(--discord-blurple);
            color: white;
        }
        .btn-discord:hover { background-color: #4752c4; }

        .btn-copy {
            background-color: #333;
            color: white;
            border: 1px solid var(--primary);
        }

        @media (max-width: 850px) {
            .home-grid { grid-template-columns: 1fr; }
            .music-content-wrapper { flex-direction: column; }
            .music-img { width: 100%; max-width: 300px; margin: 0 auto; }
            .music-info { width: 100%; text-align: center; }
            .playing-animation { justify-content: center; }
        }
    </style>
</head>
<body>

<nav>
    <div class="nav-container">
        <a href="index.html" class="logo"><img src="img/logo.png" alt="Logo"></a>
        <div class="nav-links">
            <a href="index.html">Accueil</a>
            <a href="generator.html">GÃ©nÃ©rateur</a>
            <a href="wiki.html">Wiki</a>
        </div>
    </div>
</nav>

<div id="youtube-player"></div>

<div class="container">
    <a href="wiki.html" class="wiki-btn">
        <span>EXPLORER LE WIKI</span>
        <span>â†’</span>
    </a>

    <div class="home-grid">
        <div id="music-section">
            <div id="music-container" class="music-card">
                </div>
            
            <div class="action-buttons">
                <a href="TON_LIEN_DINVITATION_DISCORD" target="_blank" class="btn btn-discord">
                    âœ¨ Rejoindre le serveur Discord !
                </a>
                <button class="btn btn-copy" onclick="copyDiscordFormat()">
                    ðŸ“‹ Copier pour Discord
                </button>
            </div>
        </div>

        <div class="discord-widget">
            <iframe src="https://discord.com/widget?id=1183880368173096983&theme=dark" width="100%" height="520" allowtransparency="true" frameborder="0" sandbox="allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts"></iframe>
        </div>
    </div>
</div>

<script>
    let musicData = {};

    fetch('data.json')
        .then(r => r.json())
        .then(data => {
            musicData = data;
            document.getElementById('music-container').innerHTML = `
                <h2 style="margin:0 0 10px 0;">${data.titre || 'Titre'} 
                    <div class="playing-animation"><div class="bar"></div><div class="bar"></div><div class="bar"></div></div>
                </h2>
                <div class="music-content-wrapper">
                    <img src="${data.image}" class="music-img">
                    <div class="music-info">
                        <p style="color:var(--primary); font-weight:bold; margin:0;">${data.artiste || 'Artiste'} â€” ${data.album || 'Album'}</p>
                        <p style="font-size:0.9em; margin:10px 0;">
                            <strong>Genre :</strong> ${data.genre || 'Inconnu'}<br>
                            <strong>Langue :</strong> ${data.langue || 'FranÃ§ais'}<br>
                            <strong>Sortie :</strong> ${data.date || 'Date'}
                        </p>
                        <div style="background:rgba(0,0,0,0.2); padding:10px; border-radius:8px; font-size:0.85em;">
                            ${data.histoire || 'Pas d\'histoire disponible.'}
                        </div>
                    </div>
                </div>
            `;
            const vId = data.url?.split('v=')[1]?.split('&')[0];
            if(vId) initYouTubeAPI(vId);
        });

    function initYouTubeAPI(vId) {
        const tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        document.head.appendChild(tag);
        window.onYouTubeIframeAPIReady = () => {
            new YT.Player('youtube-player', {
                height: '0', width: '0', videoId: vId,
                playerVars: { 'autoplay': 1, 'loop': 1, 'playlist': vId },
                events: { 'onReady': (e) => {
                    e.target.setVolume(0);
                    document.body.addEventListener('click', () => {
                        e.target.playVideo();
                        let v = 0;
                        let i = setInterval(() => { if(v<20){v++; e.target.setVolume(v);} else clearInterval(i); }, 150);
                    }, {once:true});
                }}
            });
        };
    }

    function copyDiscordFormat() {
        const text = `<@&1342094598822166588> \n\n# MUSIQUE DU JOUR\n- **Titre** : ${musicData.titre}\n- **Artiste** : ${musicData.artiste}\n- **Lien** : ${musicData.url}`;
        navigator.clipboard.writeText(text).then(() => alert("CopiÃ© !"));
    }
</script>
</body>
</html>
